name: Deploy to Vercel
on:
  push:
    branches:
      - main
  workflow_dispatch:
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Deploy
        env:
          VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}
          VERCEL_TEAM_ID: ${{ secrets.VERCEL_TEAM_ID }}
          COMMIT_SHA: ${{ github.sha }}
        run: |
          curl -sf -X POST \
            "https://api.vercel.com/v13/deployments?teamId=${VERCEL_TEAM_ID}" \
            -H "Authorization: Bearer ${VERCEL_TOKEN}" \
            -H "Content-Type: application/json" \
            -d '{"name":"fintrackapp","gitSource":{"type":"github","ref":"main","repoId":1030922283,"sha":"'"${COMMIT_SHA}"'"},"target":"production"}'
